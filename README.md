# AI-Powered PowerPoint Inconsistency Checker

This is a Python command-line tool that analyzes PowerPoint presentations for factual and logical inconsistencies across slides. It leverages Google's Gemini 1.5 multimodal AI to understand both structured text and text embedded within images, providing a comprehensive review of the presentation content.

---

## Example Report

Here is a sample report generated by the analyzer on a deck with known errors. The tool successfully identifies numerical conflicts, calculation errors, and subtle contextual inconsistencies.

> **Inconsistency Found:**
> - **Slides Involved:** Slide 1 and Slide 2
> - **Conflicting Information:** Slide 1 states **"$2M Saved"** in lost productivity, while Slide 2 claims **"$3M saved"** annually.
> - **Analysis:** The slides present conflicting monetary savings figures, making it unclear which is accurate.
>
> ---
>
> **Inconsistency Found:**
> - **Slides Involved:** Slide 3 and Slide 7
> - **Conflicting Information:** The total hours saved on Slide 3 (**50 hours/month**) does not seem to align with the individual figures mentioned elsewhere, such as the **72 hours saved per year** (6 hours/month) for "Layout Optimization" on Slide 7.
> - **Analysis:** The total savings calculation appears inconsistent between the summary on one slide and the detailed breakdown on another.
>
> ---
>
> **Inconsistency Found:**
> - **Slides Involved:** Slide 1 and Slide 7
> - **Conflicting Information:** The claim **"15 mins Saved per slide created"** is presented as a standalone result on Slide 1, but as one component among several productivity gains on Slide 7.
> - **Analysis:** While the number is consistent, the different framing creates ambiguity. It is unclear if the 15 minutes saved is the total productivity gain or just part of it.

---

## Features 

### 1. Dual-Mode Analysis

This feature provides the flexibility to analyze presentation content regardless of the format it's delivered in. It ensures the tool is adaptable to real-world workflows where content might come as a final `.pptx` file or as a set of exported slide images.

* **Technical Implementation**:
    * The script uses Python's `argparse` library to create a professional command-line interface. A `mutually_exclusive_group` is configured to ensure the user **must** provide either the `--pptx` flag or the `--image_folder` flag, but not both. This prevents ambiguous commands and guides the user toward correct usage.
    * The `main()` function contains a simple conditional block that checks which argument was provided and calls the appropriate extraction function (`extract_content_from_pptx()` or `extract_content_from_image_folder()`), directing the program flow accordingly.

### 2. Multimodal AI Engine

"Multimodal" means the AI can process and understand information from more than one type of dataâ€”in this case, both **text** and **images**. This is the most critical feature for ensuring a **complete** and thorough analysis, as vital information is often embedded in visual elements.

* **Technical Implementation**:
    * The script is configured to use `gemini-1.5-flash`, a powerful and efficient model specifically designed for multimodal tasks.
    * When an image is encountered (either from a `.pptx` file or a folder), the `Pillow` library opens and processes the image data.
    * This image data is then sent to the Gemini API along with a specific text prompt: `"Extract all text verbatim from this image."` The AI performs advanced Optical Character Recognition (OCR) and returns any text it finds, which is then added to the slide's content for analysis.

### 3. Comprehensive Inconsistency Detection

This feature represents the analytical core of the tool. It moves beyond simple keyword searching to understand the context, logic, and relationships between different pieces of information across the entire presentation.

* **Technical Implementation**:
    * **Content Aggregation**: Before analysis, all extracted text is compiled into a single, large string. Each slide's content is clearly demarcated with headers (e.g., `--- Slide 1 ---`). This structure provides the necessary context for the AI to know the origin of each piece of information.
    * **System Prompt Engineering**: The `system_prompt` variable acts as the "brain" of the operation. It is carefully crafted to instruct the AI on its persona ("You are a meticulous business analyst") and the specific types of inconsistencies to look for, including numerical conflicts, logical contradictions, and timeline mismatches. The AI leverages its vast training to apply these instructions to the provided text.

### 4. Structured & Clear Output

An analysis is only valuable if its results are easy to understand and act upon. This feature ensures the final report is both human-readable and professional, allowing users to quickly identify and address issues.

* **Technical Implementation**:
    * **Forced Output Formatting**: The system prompt contains strict instructions on how to format the findings, providing a template (`**Inconsistency Found:**...`) that the AI must follow. This makes the output predictable, structured, and easy to parse programmatically or by eye.
    * **Terminal Rendering with `rich`**: Instead of using a basic `print()` statement, the script utilizes the `rich` library. The `Markdown()` class takes the AI's formatted text and renders it correctly in the terminal, properly displaying bolding, bullet points, and other markdown features. This transforms a plain text block into a visually organized and professional-looking report.

---


## Functionality & How to Use

### 1. Setup

**Clone the repository:**
```bash
git clone <your-repo-url>
cd powerpoint-analyzer
```

**Install dependencies:**
```bash
pip install -r requirements.txt
```

**Set up your API Key:**
Create a `.env` file in the project root and add your Google API key:
```
GOOGLE_API_KEY="YOUR_API_KEY_HERE"
```

### 2. Execution

The script runs from the terminal and requires one of two mutually exclusive arguments.

**To analyze a `.pptx` file:**
```bash
python analyzer.py --pptx path/to/your/presentation.pptx
```

**To analyze a folder of slide images:**
*Note: For best results, ensure images are named sequentially (e.g., `slide_01.jpg`, `slide_02.jpg`).*
```bash
python analyzer.py --image_folder path/to/your/image_folder/
```

---

## Limitations

This tool is a powerful assistant but has limitations inherent to current AI technology.

1.  **AI Reliability**: The analysis is performed by an LLM, which can occasionally "hallucinate" or misinterpret nuanced context. The output should be used as a guide for a human reviewer, not as an absolute final verdict.
2.  **Complex Visual Interpretation**: The AI can read text from charts and graphs but does not interpret the visual data itself. For example, it would not know if a trend line contradicts a statement like "steady growth" unless the text values are also present.
3.  **Image Quality Dependency**: The accuracy of the text extraction from images (OCR) is highly dependent on the resolution, clarity, and font of the text in the images. Blurry or highly stylized text may not be read correctly.
4.  **Lack of External Context**: The tool only analyzes the content provided within the presentation. It cannot detect inconsistencies with external data, unstated company goals, or broader market knowledge.
5.  **Scalability Constraints**: While designed to handle large presentations, analyzing very large decks (200+ slides) with many high-resolution images can be time-consuming and may incur higher API costs.
